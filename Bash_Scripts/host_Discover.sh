#!/bin/bash

#colors
BLACK='\033[0;30m'
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[0;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
WHITE='\033[0;37m'
GRAY='\033[0;90m'
END='\033[0m'

function ctrl_c(){
  echo -e "\n\n[!!]Goodbye"
  tput cnorm; exit 1
}

trap ctrl_c INT 

function banner(){
     

echo -e "\e[033m\e[0;36m ________               __        ________       ___ \e[0m"
echo -e "\e[033m\e[0;36m \______ \_______  ____|__|__  ___\_____  \   __| _/ \e[0m"
echo -e "\e[033m\e[0;36m |    |  \_  __ \/  _ \|  \  \/  /  _(__  <  / __ |  \e[0m"
echo -e "\e[033m\e[0;36m |    |   \   |    <_> )  |>    <  /       \/ /_/ |  \e[0m"
echo -e "\e[033m\e[0;36m /_______  /__|\____/|__/__/\___\/_/________/\____|  \e[0m"
echo -e "\e[033m\e[0;36m         \/                      \/       \/      \/   \e[0m"
                echo -e  "\t\t${PURPLE}   Created by ~${endColour}${PURPLE}Droix3d  ${endColour}\n"
                echo -e  "\t\t${WHITE}~${endColour}${YELLOW}Host discovery with operating system${endColour}${WHITE}~${endColour}\n"
}

banner

echo -e "\t\tPrinting network interfaces....\n"

for i in {1..20};do
    echo -n "."
    sleep 0.1 # Pausa de 1 segundo
done
echo

clear

ifconfig | awk '/^[a-z]/ {gsub(":", "", $1); iface=$1} /inet / {ip=$2} /netmask / {print iface " : " ip " " $4}' | grep -v 127.0.0.1  && echo -e -n "\nEnter the base IP address of the network you wish to scan (example: 192.168.1): " && read -r code

echo -e "${RED}\n\t\t>>>> Scanning hosts on the network  $code <<<<${endColour}"

tput civis
for i in $(seq 1 254); do
( 
  response=$(timeout 1 bash -c "ping -c 1 $code.$i"  | grep "ttl") 
  if [[ $response ]]; then
    ttl_value=$(echo $response | awk -F ' ' '{print $6}')

    if ((ttl_value > 100));then
      os=Windows
    elif ((ttl_value < 100));then
      os=Linux/Unix
    fi

    echo -e "\n${WHITE}[+] Host 192.168.94.$i - ACTIVE - $ttl_value - SISTEMA OPERATIVO - $os ${endColour}" 
  fi
) &
done;wait
tput cnorm 
